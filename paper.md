---
title: 'Lerche.jl: Generating fast data file processors from EBNF grammars'
tags:
  - Julia
  - data processing
  - data formats
  - EBNF
authors:
  - name: James R. Hester^[Corresponding author]
    orcid: 0000-0002-2004-8672
    affiliation: 1
  - name: Erez Shinan
    affiliation: 2
affiliations:
  - name: Australian Nuclear Science and Technology Research Organisation, Sydney, Australia
    index: 1
  - name: xxx
    index: 2
date: 23 April 2021
bibliography: paper.bib
---

# Summary

In a scientific context, structured text is commonly encountered in
data files and domain-specific languages (DSLs) for handling
data. Extended Backhaus-Naur Format (EBNF) is a well-established
standard for describing the syntax of such structured text
[@ebnf]. When provided with an EBNF description of a data file format
or language, `Lerche.jl` automatically generates a parser that
processes any text that conforms to that EBNF. The parse tree can be
immediately transformed into application-specific data structures
using user-supplied rules. This parser generator fills a gap in
standards-based scientific work for the Julia ecosystem.

# Statement of Need

Standards for scientific data formats are essential for correct
interpretation of data produced and consumed by parties that are not
in direct contact.  Standardisation is also becoming increasingly
important as requirements for accessible and reusable data increase
among funding bodies and publishers. Use of formal description
languages, such as EBNF, remove ambiguity that may arise when using
natural language descriptions for these standards. Furthermore, a
parser that is machine-generated from an EBNF description is
guaranteed to generate a correct parse tree from conformant data,
unlike hand-written parsers.

Scientific data readers typically form a small component of larger
projects, which will dictate the programming environment and
policies. This environment restricts the choice of EBNF parser
generators; an EBNF parser generator that executes in the usual
project environment is preferable to one that introduces new
build-time dependencies and environments. `Lerche.jl` was translated
into Julia from the Python Lark project [@lark] in order to remove the
need for any extra language dependencies or build steps when
developing standards-conformant data format readers for Julia
projects. The generated parsers run within the Julia language
environment, and are straightforward to integrate into larger Julia
projects.

Other native parser tools available for Julia projects include
`ParserCombinator` [@parsercombinator], `Pegparser` [@pegparser], and
the built-in Julia macro system. None of these take EBNF as input. Reliance
on EBNF parser generators external to the Julia environment, for example
by calling Lark or pre-generating parsers, complicate distribution and
create a barrier to user contribution to packages.

dREL [@spadaccini_drel:_2012] is a relational data processing language
for specifying crystallographic algorithms. The dREL EBNF [@drelenbf]
was developed using `Lerche.jl` to verify its consistency. Package
`DrelTools.jl` [@dreltools] is built around the parser automatically
generated by `Lerche.jl` from this EBNF. `Lerche.jl` is also used by
`CrystalInfoFramework.jl` [@cifjl] to generate the parser for data
files written in the Crystallographic Information Framework (CIF)
format [@Bernstein:aj5269].

# Performance

One of Julia's advantages is the potential for performance close to 
that of a compiled language, while retaining features normally found in
high-level interpreted languages. Tests show that parsing a 500K mmCIF
text file from the worldwide Protein Data Bank [@wwpdb] is around 3 times
faster using `Lerche.jl` compared to Lark, if initial compilation time is
ignored.

# References
